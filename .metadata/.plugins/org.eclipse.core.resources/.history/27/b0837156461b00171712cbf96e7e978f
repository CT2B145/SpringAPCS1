package textExcel;

public class FormulaCell extends RealCell{
	private String formanswer;
	// Constructor for the FormulaCell class
	public FormulaCell (String enteredForm){
		super(enteredForm);
		this.formanswer = enteredForm;
	}

	@Override
	public String abbreviatedCellText() {
		
		String[] fracEquationHolder = this.formanswer.split(" ",this.formanswer.length()); // holds the fractions and operator
		String operators = "";
		double operand;
		double operand2;
		double answer = 0;

		for(int i =0; i <= (fracEquationHolder.length-2); i+=2){
			operators = fracEquationHolder[i+1];
			operand = Double.parseDouble(fracEquationHolder[i]);
			operand2 = Double.parseDouble(fracEquationHolder[i+2]);
			if(operators.indexOf("+")>=0){
				answer = operand + operand2;
			}else if(operators.indexOf("-")>=0){
				answer = operand - operand2;
			}else if(operators.indexOf("*")>=0){
				answer = operand * operand2;
			}else if(operators.indexOf("/")>=0){
				answer = operand / operand2;
			}else
				return answer + "";
		}
		return answer+""; 
		
	}

	@Override
	public String fullCellText() {
		return super.fullCellText();
	}
	public double getDoubleValue (){ // truncates it
		return Double.parseDouble(this.formanswer.substring(0, this.formanswer.length()-1))/100;
		
	}
	
}